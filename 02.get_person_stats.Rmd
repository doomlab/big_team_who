---
title: "Get Person Ids"
author: "Erin M. Buchanan"
date: "Last Knitted: `r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Libraries

```{r}
library(dplyr)
library(rio)
library(bib2df)
```


## Import the BibTeX File

In this section, we are importing the bibtex file that includes all the papers we are going to use. 

Notes:

  - We used the preprint manuscript for some papers because they had the entire author list, we will update their references manually for the final dataset. 
  - We will have to manually add the names for several papers that used consortium authors. 
  - The pre-reg of this document only examines a few authors/papers to ensure code can be run and develop workflow. 

```{r}
bibs <- bib2df("papers.bib")
```

## Match to IDs

In trying to run our `01.get_person_ids.Rmd` file, we figured out that a lot of the data did not bring up matches. Therefore, we coded most scholar and orcids by hand.

```{r}
id_list <- import("test_utf8.xlsx")
```



## Get Person Statistics 

```{r}
erin_df <- rorcid::works("0000-0002-9689-4189") %>%
  as_tibble() %>%
  janitor::clean_names() %>%
  dplyr::mutate(created_date_value = anytime::anydate(created_date_value/1000))

table(erin_df$type)

erin_df$title_title_value <- tolower(erin_df$title_title_value)
erin_df$title_title_value <- gsub("[[:punct:]]", "", erin_df$title_title_value)
nrow(erin_df)

# remove real duplicates
temp <- erin_df[!duplicated(erin_df[ , c("type", "title_title_value") ]), ]
nrow(temp)

# combine types
erin_df$our_type <- erin_df$type
erin_df$our_type <- gsub("other|data-set|preprint", "open_science_pubs", erin_df$our_type)

table(erin_df$our_type)

erin_ed <- orcid_educations("0000-0002-9689-4189") %>% 
  as_tibble() %>%
  janitor::clean_names() 

orcid_employments("0000-0002-9689-4189")

```


Person statistics: 
- Career length: from first pub, from first degree
  `publication_date_year_value` anything 
- Employment levels
- Education levels
- # Of works: separate to total, other/preprint/data-set, journal/book/traditional
- Limitations of this system

...average citation rates/h index/i10 index 

Journal statistics: 
- Which journals are publishing this information
  - make sure preprints we are using also have real journal merged in 
- Types of big team research (social, cognitive)
  - keywords 
- Over time: are things becoming more varied
  - are the publications more varied over time 